<!DOCTYPE html>

<html>

<head>

    <title>Weather Map API</title>

    <link rel="stylesheet" href="/css/weather_map.css">

</head>

<body>
    <h1>Weather Map</h1>

    <div id='weatherDisplay'>
    </div>

    <script src="/js/jquery.js"></script>
    <script>
        'use strict';

        //(function(){

            var ajaxRequest = $.get("http://api.openweathermap.org/data/2.5/weather", {
                APPID: "b54d0e81b7e778b1069994155f89db72",
                q:     "San Antonio, TX",
                units: "imperial"
            });


            ajaxRequest.always(function(){
                console.log('Request sent');
            });

            ajaxRequest.fail(function(data, error){
                console.log(error);
                console.log(ajaxRequest.status);
            });

            ajaxRequest.done(function(data){
                console.log('Request returned successfully');
                console.log(data); 

            var displayContent = function(){
                var icon = data.weather[0].icon;
                var city = '<p>' + 'San Antonio' + '</p>';
                var image  = '<p>' + "<img src = 'http://openweathermap.org/img/w/" + icon + ".png'>" + '</p>';
                var lowTemp = '<p>' + 'Lo: ' + data.main.temp_min + '</p>';
                var highTemp = '<p>' + 'High: ' + data.main.temp_max + '</p>';
                var humidity = '<p>' + 'Humidity: ' + data.main.humidity + '</p>';
                var pressure = '<p>' + 'Pressure: ' + data.main.pressure + '</p>';

                var displayText = city + image + lowTemp + highTemp + humidity + pressure;
                $('#weatherDisplay').append(displayText); 
            };

            displayContent();

            });


        //})();
    </script>

</body>

</html>